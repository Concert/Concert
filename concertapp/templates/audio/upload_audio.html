{% extends 'base_site.html' %}

{% block content %}

<h3>Upload</h3>

{#  Form that user sees #}
<div id="status_container">
    <p>
        Uploading<span id="status_animated_dots"></span><br />
        Please be patient.  This may take some time.
    </p>
</div>

<div id="upload_panel_container">
    <label for="file_uploader" id="file_uploader_label">Select a file to upload: </label>
    {# This will be populated client-side with the actual '<input>' element #}
    <div id="choose_file_container"></div>
    {# This is the listing of files that the user has chosen #}
    <div id="files_table" class="table"></div>
    <button id="upload_submit_button">Upload</button>

    {# Form that is actually used to send data to server #}
    <form id="server_upload_form" action="/audio/upload/" method="POST" class="hidden">
        {# Each file that needs to be uploaded will get injected into here #}
    </form>    
</div>



<!-- Client side templates -->
<script id="uploadfilewidget_template" type="text/x-jquery-tmpl">
    <div class="uploadfilewidget table-row" id="uploadfilewidget-${id}">
        <div class="uploadfilewidget_filename table-cell" id="uploadfilewidget_filename-${id}">${filename}</div>
        <div class="uploadfilewidget_collection_selector_container table-cell">
            <select id="uploadfilewidget_collection_selector-${id}" class="uploadfilewidget_collection_selector" name="collection">
                <option value="-1">Please select a collection</option>
                {# Server side templating, to populate dropdowns #}
                {% for collection in user.collections.all %}
                    <option value="{{ collection.id }}">{{ collection.name }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="uploadfilewidget_progress_container table-cell">
            <progress id="uploadfilewidget_progress-${id}" class="uploadfilewidget_progress" max=1 value=0 />
       </div>
    </div>
</script>

<script id="file_chooser_template" type="text/x-jquery-tmpl">
    <input name="audio" type="file" multiple="false" id="file_chooser-${id}" accept="audio/*" />
</script>

{% endblock %}
